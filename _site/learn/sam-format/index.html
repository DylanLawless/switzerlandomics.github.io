<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>What is the SAM format?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" sizes="32x32"   href="/images/favicon-32x32.png">
  <link rel="apple-touch-icon"      sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">
  <!-- Google Fonts CDN -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <!-- Self host font -->
  <!-- <link rel="preload" href="/assets/fonts/playfair-display.woff2" as="font" type="font/woff2" crossorigin> -->
  <link href="/assets/css/style.css" rel="stylesheet">
  <link href="/assets/css/custom.css" rel="stylesheet">
  
  <meta name="description" content="Explanation of the Sequence Alignment/Map text format used to store sequencing read alignments" />
  <meta property="og:title" content="What is the SAM format?"/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content=""/>
  
  <meta property="og:description" content="Explanation of the Sequence Alignment/Map text format used to store sequencing read alignments"/>
  <meta name="twitter:card" content="summary"/>
  
  

</head>

<body class='page page-learn-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  
  <ul>
    
    <li class="">
      <a href="/technologies/">Technologies</a>
    </li>
    
    <li class="">
      <a href="/team/">Team</a>
    </li>
    
    <li class="">
      <a href="/publications/">Publication</a>
    </li>
    
    <li class="">
      <a href="/releases/">Releases</a>
    </li>
    
    <li class="">
      <a href="/partnerships/">Partners</a>
    </li>
    
    <li class="">
      <a href="/about/">About</a>
    </li>
    
    <li class="">
      <a href="/blog/">Blog</a>
    </li>
    
    <li class="">
      <a href="/contact/">Contact</a>
    </li>
    
  </ul>
</div>

  <div id="wrapper" class="wrapper">
    <!-- <a href="/"> -->

<div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/">
        <span><img width="50px" height="50px" alt="SwitzerlandOmics" src="/images/logo/logo_v2.svg" /></span>
        <span class="logo-text">Switzerland Omics</span>
      </a>
    </div>
    <div class="logo-mobile">
      <a href="/">
        <span><img width="39px" height="39px" alt="SwitzerlandOmics" src="/images/logo/logo_v2.svg" /></span>
        <span class="logo-text">Switzerland Omics</span>
      </a>
    </div>
    <div id="main-menu" class="main-menu">
  
  <ul>
    
    <li class="">
      <a href="/technologies/">Technologies</a>
    </li>
    
    <li class="">
      <a href="/team/">Team</a>
    </li>
    
    <li class="">
      <a href="/publications/">Publication</a>
    </li>
    
    <li class="">
      <a href="/releases/">Releases</a>
    </li>
    
    <li class="">
      <a href="/partnerships/">Partners</a>
    </li>
    
    <li class="">
      <a href="/about/">About</a>
    </li>
    
    <li class="">
      <a href="/blog/">Blog</a>
    </li>
    
    <li class="">
      <a href="/contact/">Contact</a>
    </li>
    
  </ul>
</div>

    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button" aria-label="Mobile Menu">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>






    <div class="container pb-6 pt-6 pt-md-10 pb-md-10">
  <div class="row justify-content-start">
    <div class="col-12 col-md-8">
      <div class="tech tech-single">

        <h1 class="title">What is the SAM format?</h1>

        
        <p class="lead">Explanation of the Sequence Alignment/Map text format used to store sequencing read alignments</p>
        

        <div class="content">
          <p>The SAM format (Sequence Alignment/Map) is a tab-delimited text format used to record how sequencing reads align to a reference genome, including their positions, orientation, and alignment characteristics.</p>

<p>SAM provides a standard, human-readable representation of read alignments that can be exchanged between tools and inspected directly when debugging pipelines.</p>

<h2 id="why-sam-files-exist">Why SAM files exist</h2>

<p>After sequencing, reads are aligned to a reference genome to determine where each fragment originated. Alignment tools must then store both placement and alignment details for downstream analysis.</p>

<p>SAM provides a portable and readable format so alignment results can move between tools for variant calling, quality control, and coverage analysis.</p>

<p>In practice, SAM is usually converted immediately into its compressed binary equivalent, BAM.</p>

<h2 id="core-structure-of-a-sam-file">Core structure of a SAM file</h2>

<p>A SAM file has two sections.</p>

<p>Header lines begin with <code class="language-plaintext highlighter-rouge">@</code> and describe reference sequences and processing information such as sorting order and software used.</p>

<p>Alignment lines follow, with one line per read alignment. Each alignment line contains mandatory columns describing mapping location, alignment structure, and read sequence, followed by optional fields that store additional annotations.</p>

<p>Each alignment line contains at least eleven tab-separated fields, including:</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>QNAME</td>
      <td>Read identifier</td>
    </tr>
    <tr>
      <td>FLAG</td>
      <td>Bitwise mapping flags</td>
    </tr>
    <tr>
      <td>RNAME</td>
      <td>Reference sequence name</td>
    </tr>
    <tr>
      <td>POS</td>
      <td>1-based alignment position</td>
    </tr>
    <tr>
      <td>MAPQ</td>
      <td>Mapping quality</td>
    </tr>
    <tr>
      <td>CIGAR</td>
      <td>Alignment operations</td>
    </tr>
    <tr>
      <td>SEQ</td>
      <td>Read sequence</td>
    </tr>
    <tr>
      <td>QUAL</td>
      <td>Base quality values</td>
    </tr>
  </tbody>
</table>

<p>Optional fields allow tools to attach additional information without breaking compatibility.</p>

<h2 id="example-alignment-record">Example alignment record</h2>

<p>Example alignment line:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
r001  99  chr1  10001  60  50M  = 10100  149  ACTG...  FFFF...

</code></pre></div></div>

<p>Interpretation:</p>

<ul>
  <li>Read <code class="language-plaintext highlighter-rouge">r001</code> aligns to chromosome 1 at position 10001.</li>
  <li>Mapping quality indicates confidence in placement.</li>
  <li><code class="language-plaintext highlighter-rouge">50M</code> in the CIGAR string indicates 50 aligned bases.</li>
  <li>The FLAG value encodes pairing and orientation.</li>
  <li>Sequence and quality fields store read bases and base quality scores.</li>
</ul>

<p>Optional fields may follow with additional annotations.</p>

<h2 id="details-that-matter">Details that matter</h2>

<ul>
  <li>Positions use <strong>1-based coordinates</strong>, unlike some other genomic formats.</li>
  <li>Whether a read is mapped must be determined from the FLAG field.</li>
  <li>CIGAR operations describe matches, insertions, deletions, and clipping relative to the reference.</li>
  <li>A read may appear in multiple records if it maps to several locations or has split alignments.</li>
  <li>SAM files are large and usually converted to BAM for storage and analysis.</li>
</ul>

<h2 id="common-interpretation-mistakes">Common interpretation mistakes</h2>

<p>Frequent errors include:</p>

<ul>
  <li>Treating POS as 0-based coordinates.</li>
  <li>Ignoring FLAG bits when determining mapping status.</li>
  <li>Misreading CIGAR strings as simple sequence length.</li>
  <li>Assuming each read appears only once.</li>
</ul>

<h2 id="where-sam-fits-in-pipelines">Where SAM fits in pipelines</h2>

<p>Typical workflow:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Sequencing → Alignment → SAM → BAM → Variant calling → Interpretation

</code></pre></div></div>

<p>SAM is often an intermediate format used for inspection before compression.</p>

<h2 id="sam-and-bam">SAM and BAM</h2>

<p>BAM is the compressed binary representation of SAM. Both formats store the same alignment information, but BAM is smaller and allows indexed region access.</p>

<p>Most production pipelines store alignments as BAM rather than SAM.</p>

<h2 id="technical-specification">Technical specification</h2>

<p>The official SAM and BAM specifications are maintained in the hts-specs repository:</p>

<p>https://github.com/samtools/hts-specs</p>


        </div>

      </div>
    </div>
  </div>
</div>


  </div>
  <div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="footer-inner">
          <!-- <h2 class="footer-title">SwitzerlandOmics</h2> -->

		  <!-- requires clearing to update config -->
		  <!-- bundle exec jekyll clean -->
		  <!-- bundle exec jekyll serve -->
		  <p class="footer-title">Technically sound. Incredibly simple.</p>
          <ul>
            
            
            <li class="">
              <a href="/">Home</a>
            </li>
            
            <li class="">
              <a href="/contact/">Contact</a>
            </li>
            
            <li class="">
              <a href="https://docs.switzerlandomics.ch">Docs</a>
            </li>
            
            <li class="">
              <a href="/learn/">Learn</a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          
            <div class="social">
  
    <a href="https://github.com/DylanLawless/switzerlandomics.github.io" target="blank"><img src="/images/social/github.svg" title="Github" alt="Github" /></a>
  
    <a href="mailto:admin@switzerlandomics.ch " target="blank"><img src="/images/social/email.svg" title="Email" alt="Email" /></a>
  
</div>

          
          
        </div>
      </div>
    </div>
  </div>
</div>
  <script type="text/javascript" src="/assets/js/scripts.js"></script>
  


<script>
  window.addEventListener('DOMContentLoaded', function () {
    const iframe = document.getElementById('responsive-iframe');

    function resizeIframe() {
      try {
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        const rawHeight = doc.documentElement.scrollHeight;
        const paddedHeight = Math.ceil(rawHeight * 1.1);  // add 10%
        <!-- const paddedHeight = Math.max(Math.ceil(rawHeight * 1.08)); // max height safeguard -->

        iframe.style.height = paddedHeight + 'px';
      } catch (e) {
        console.warn('Could not auto-resize iframe:', e);
      }
    }

    iframe.addEventListener('load', function () {
      resizeIframe();
      setTimeout(resizeIframe, 150);  // in case datatable renders late
    });
  });
</script>
</body>

</html>
